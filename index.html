<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitFlow Pro | Lead Coach Dashboard</title>
    <style>
        :root { --primary: #1a5276; --accent: #2ecc71; --bg: #f0f3f4; --whatsapp: #25d366; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; }
        .header { background: var(--primary); color: white; padding: 20px; text-align: center; border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; }
        .container { max-width: 450px; margin: auto; padding: 15px; }
        .card { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h2 { font-size: 1rem; color: var(--primary); margin-top: 0; text-transform: uppercase; border-left: 4px solid var(--accent); padding-left: 10px; }
        .water-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; }
        .glass { background: #e8f6ff; border: 2px solid #3498db; border-radius: 8px; height: 50px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; cursor: pointer; }
        .glass.full { background: #3498db; color: white; }
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 10px; font-size: 1rem; }
        button { background: var(--primary); color: white; border: none; font-weight: bold; cursor: pointer; }
        .btn-add { background: var(--accent); }
        .btn-whatsapp { background: var(--whatsapp); margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-reset { background: #e74c3c; margin-top: 20px; opacity: 0.8; }
        .meal-item { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 8px 0; font-size: 0.9rem; }
        .footer { text-align: center; font-size: 0.8rem; color: #7f8c8d; margin-top: 20px; }
    </style>
</head>
<body onload="loadData()">

<div class="header">
    <h1 style="margin:0; font-size: 1.5rem;">FitFlow Pro</h1>
    <span style="font-size: 0.8rem; opacity: 0.9;">Lead Coach Dashboard</span>
</div>

<div class="container">
    <div class="card">
        <h2>Target Weight Goal</h2>
        <input type="number" id="h" placeholder="Enter Height (cm)" onchange="calc()">
        <div id="targetDisplay" style="text-align:center; font-weight:bold; margin-top:10px; color:var(--primary);"></div>
    </div>

    <div class="card">
        <h2>Daily Activity</h2>
        <input type="number" id="stepCount" placeholder="Enter Steps (e.g. 10000)" oninput="saveSteps()">
        <p style="text-align:center; font-size: 0.8rem; color: #666;">Recommended: 10,000 steps/day</p>
    </div>

    <div class="card">
        <h2>Hydration (250ml glasses)</h2>
        <div class="water-grid" id="waterGrid"></div>
        <p style="text-align:center; margin-top:10px; font-weight:bold;">Total: <span id="totalWater">0</span> Liters</p>
    </div>

    <div class="card">
        <h2>South Indian Meal Log</h2>
        <select id="meal">
            <option value="250">2 Idli + Sambar</option>
            <option value="350">Masala Dosa</option>
            <option value="200">Curd Rice (1 Cup)</option>
            <option value="150">Ragi Malt</option>
            <option value="450">Veg Thali</option>
            <option value="100">Coffee / Tea</option>
        </select>
        <button class="btn-add" onclick="addMeal()">Add Meal</button>
        <div id="mealList"></div>
        <p style="text-align:right; font-weight:bold;">Total: <span id="totalCal">0</span> kcal</p>
    </div>

    <div class="card" style="border: 2px solid var(--whatsapp);">
        <h2>Coach Review</h2>
        <button class="btn-whatsapp" onclick="shareWhatsApp()">Share Report via WhatsApp</button>
    </div>

    <button class="btn-reset" onclick="resetDay()">Clear Daily Logs</button>

    <div class="footer">
        <a href="legal.html" style="text-decoration:none; color:inherit;">Privacy Policy</a> | 
        <a href="contact.html" style="text-decoration:none; color:inherit;">Contact Coach</a>
    </div>
</div>

<script>
    let waterState = [0,0,0,0,0,0,0,0];

    // --- Water Logic ---
    function setupWater() {
        const grid = document.getElementById('waterGrid');
        grid.innerHTML = '';
        waterState.forEach((state, i) => {
            let div = document.createElement('div');
            div.className = state ? 'glass full' : 'glass';
            div.innerHTML = 'üíß';
            div.onclick = () => toggleWater(i);
            grid.appendChild(div);
        });
        document.getElementById('totalWater').innerText = (waterState.filter(s => s).length * 0.25).toFixed(2);
    }

    function toggleWater(index) {
        waterState[index] = waterState[index] ? 0 : 1;
        localStorage.setItem('ff_water', JSON.stringify(waterState));
        setupWater();
    }

    // --- Goal/Weight Logic ---
    function calc() {
        let h = document.getElementById('h').value;
        if(!h) return;
        let target = (23 * ((h/100)*(h/100))).toFixed(1);
        document.getElementById('targetDisplay').innerText = "Healthy Goal: " + target + " kg";
        localStorage.setItem('ff_height', h);
    }

    // --- Steps Logic ---
    function saveSteps() {
        let steps = document.getElementById('stepCount').value;
        localStorage.setItem('ff_steps', steps);
    }

    // --- Meal Logic ---
    function addMeal() {
        let select = document.getElementById('meal');
        let name = select.options[select.selectedIndex].text;
        let cal = parseInt(select.value);
        let meals = JSON.parse(localStorage.getItem('ff_meals') || '[]');
        meals.push({name, cal});
        localStorage.setItem('ff_meals', JSON.stringify(meals));
        renderMeals();
    }

    function renderMeals() {
        let meals = JSON.parse(localStorage.getItem('ff_meals') || '[]');
        let list = document.getElementById('mealList');
        list.innerHTML = '';
        let total = 0;
        meals.forEach(m => {
            total += m.cal;
            list.innerHTML += `<div class="meal-item"><span>${m.name}</span><span>${m.cal} kcal</span></div>`;
        });
        document.getElementById('totalCal').innerText = total;
    }

    // --- WhatsApp Logic ---
    function shareWhatsApp() {
        let water = document.getElementById('totalWater').innerText;
        let cals = document.getElementById('totalCal').innerText;
        let target = document.getElementById('targetDisplay').innerText;
        let steps = document.getElementById('stepCount').value || "Not logged";
        
        let text = `*FitFlow Pro: Daily Summary*%0A` +
                   `---------------------------%0A` +
                   `üéØ ${target}%0A` +
                   `üèÉ Steps: ${steps}%0A` +
                   `üíß Water: ${water} Liters%0A` +
                   `üçé Nutrition: ${cals} kcal%0A` +
                   `---------------------------%0A` +
                   `Review requested by Lead Coach.`;
        
        window.open(`https://wa.me/?text=${text}`, '_blank');
    }

    // --- App Lifecycle ---
    function loadData() {
        let h = localStorage.getItem('ff_height');
        if(h) { document.getElementById('h').value = h; calc(); }
        
        let s = localStorage.getItem('ff_steps');
        if(s) document.getElementById('stepCount').value = s;

        let w = localStorage.getItem('ff_water');
        if(w) waterState = JSON.parse(w);
        setupWater();
        renderMeals();
    }

    function resetDay() {
        if(confirm("Clear today's logs (Steps, Water, Meals)?")) {
            localStorage.removeItem('ff_water');
            localStorage.removeItem('ff_meals');
            localStorage.removeItem('ff_steps');
            waterState = [0,0,0,0,0,0,0,0];
            document.getElementById('stepCount').value = '';
            setupWater();
            renderMeals();
        }
    }
</script>

</body>
</html>
